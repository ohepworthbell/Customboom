/*
 *	Basic game to catch falling elements
 *	Pure JavaScript (vanilla - no dependencies)
 *	Requires canvas support (IE9+, all versions of Chrome, Firefox and Safari)
 */

function reset(){ball.y=-500,ball.ny=-500,ball.x=edges+parseInt((rightbound-edges)*Math.random())}function draw(){ctx.clearRect(0,0,canvas.width,canvas.height),ball.y>platform-30&&ball.y<platform+(15+pixelSize)&&ball.x<relmove+(25+pixelSize)&&ball.x>relmove-(25+pixelSize)&&(score++,showscore.innerHTML="Caught! Your score is now "+score,score==checkpoint+checkscore&&(ball.a++,checkpoint=score),reset()),ball.y>canvas.height+20&&(life--,ball.a=speed,1==life?(showlives.innerHTML="You lost a life! You have "+life+" life remaining",reset()):1>life?(showlives.innerHTML="GAME OVER! You have no more lives remaining",ball.color="transparent",ball.a=0):(showlives.innerHTML="You lost a life! You have "+life+" lives remaining",reset())),ball.draw(),tin.draw(),ball.y+=ball.a,ball.ny=pixelSize*Math.floor(ball.y/pixelSize),paused||(raf=window.requestAnimationFrame(draw))}function moveTin(e){relw=canvas.width/canvas.offsetWidth,relmove=parseInt(relw*e),edges>relmove?relmove=edges:relmove>rightbound&&(relmove=rightbound),tin.x=pixelSize*Math.floor(relmove/pixelSize)}var edges=200,tabletop=130,canvas=document.getElementById("customboom"),ctx=canvas.getContext("2d"),raf,i,move,touchobj,relw,relmove,tinimg,start=0,speed=8,rightbound=canvas.width-edges,platform=canvas.height-tabletop,life=3,score=0,checkpoint=0,checkscore=5,showlives=document.getElementById("lives"),showscore=document.getElementById("score"),pixelSize=5,paused=!1,ballImg=document.createElement("img"),ball={x:edges+(rightbound-edges)*Math.random(),y:-500,ny:-500,a:speed,opacity:1,draw:function(){ctx.drawImage(ballImg,this.x-25,this.ny-50,50,50)}};ballImg.src="./img/ball.png";var tinimg=document.createElement("img");tinimg.addEventListener("load",function(){ctx.drawImage(tinimg,(canvas.width-50)/2,platform-50,100,100)},!1),tinimg.src="./img/tin.png";var tin={x:canvas.width/2,y:platform,draw:function(){ctx.drawImage(tinimg,this.x-50,this.y-50,100,100)}};canvas.addEventListener("mousemove",function(e){move=e.clientX-canvas.getBoundingClientRect().left,moveTin(move)}),canvas.addEventListener("touchmove",function(e){touchobj=e.changedTouches[0],move=touchobj.clientX-canvas.offsetLeft,moveTin(move)}),canvas.addEventListener("click",function(e){0==start&&(start=1,raf=window.requestAnimationFrame(draw),canvas.style.cursor="none",showscore.innerHTML="Your current score is "+score)}),canvas.addEventListener("touchstart",function(e){0==start&&(start=1,raf=window.requestAnimationFrame(draw),canvas.style.cursor="none",showscore.innerHTML+="Your current score is "+score)}),ball.draw(),tin.draw(),document.body.onkeyup=function(e){(32==e.keyCode||27==e.keyCode||13==e.keyCode||80==e.keyCode)&&(e.preventDefault(),paused?(paused=!1,canvas.style.cursor="none",raf=window.requestAnimationFrame(draw)):(paused=!0,canvas.style.cursor="default"))};
