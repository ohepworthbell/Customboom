/* 
 *	Basic game to catch falling elements
 *	Pure JavaScript (vanilla - no dependencies)
 *	Requires canvas support (IE9+, all versions of Chrome, Firefox and Safari)
 */

function speedUp(){}function reset(){tomato.y=-500,tomato.x=edges+parseInt((rightbound-edges)*Math.random())}function draw(){ctx.clearRect(0,0,canvas.width,canvas.height),tomato.y>platform-40&&tomato.y<platform+10&&tomato.x<relmove+25&&tomato.x>relmove-25&&(score++,audit.innerHTML="<p>Caught! Your score is now "+score+"</p>",score==checkpoint+checkscore&&(tomato.a++,checkpoint=score),reset()),tomato.y>canvas.height+20&&(life--,tomato.a=speed,1==life?(audit.innerHTML="<p>You lost a life! You have "+life+" life remaining</p>",reset()):1>life?(audit.innerHTML="<p>GAME OVER</p>",tomato.color="transparent",tomato.a=0):(audit.innerHTML="<p>You lost a life! You have "+life+" lives remaining</p>",reset())),tomato.draw(),tin.draw(),tomato.y+=tomato.a,raf=window.requestAnimationFrame(draw)}function moveTin(e){relw=canvas.width/canvas.offsetWidth,relmove=parseInt(relw*e),edges>relmove?relmove=edges:relmove>rightbound&&(relmove=rightbound),tin.x=relmove}var edges=200,tabletop=140,canvas=document.getElementById("game"),ctx=canvas.getContext("2d"),raf,i,move,touchobj,relw,relmove,tinimg,start=0,speed=10,rightbound=canvas.width-edges,platform=canvas.height-tabletop,life=3,score=0,checkpoint=0,checkscore=5,audit=document.getElementById("gametrail"),tomato={x:edges+parseInt((rightbound-edges)*Math.random()),y:-500,a:speed,radius:25,opacity:1,color:"#ec3e31",draw:function(){ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),ctx.closePath(),ctx.fillStyle=this.color,ctx.fill()}},tinimg=document.createElement("img");tinimg.addEventListener("load",function(){ctx.drawImage(tinimg,(canvas.width-40)/2,platform-40,80,80)},!1),tinimg.src="./img/tin.png";var tin={x:canvas.width/2,y:platform,draw:function(){ctx.drawImage(tinimg,this.x-40,this.y-40,80,80)}};canvas.addEventListener("mousemove",function(e){move=e.clientX-canvas.getBoundingClientRect().left,moveTin(move)}),canvas.addEventListener("touchmove",function(e){touchobj=e.changedTouches[0],move=touchobj.clientX-canvas.offsetLeft,moveTin(move)}),canvas.addEventListener("click",function(e){0==start&&(start=1,raf=window.requestAnimationFrame(draw),canvas.style.cursor="none",audit.innerHTML+="<p>You current score is "+score+". You have "+life+" lives.</p>")}),canvas.addEventListener("touchstart",function(e){0==start&&(start=1,raf=window.requestAnimationFrame(draw),canvas.style.cursor="none",audit.innerHTML+="<p>You current score is "+score+". You have "+life+" lives.</p>")}),tomato.draw(),tin.draw();